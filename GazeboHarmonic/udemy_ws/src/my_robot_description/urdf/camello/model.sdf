<?xml version='1.0' encoding='ASCII'?>
<sdf version="1.7">
    <model name="camello">
        <self_collide>false</self_collide>
        <pose> 0.0 0 0.0 0 0 0</pose>
        <static>false</static>

        <!-- BASE -->

        <link name="base_link">
            <!-- wheel radius = 0.133 -->
            <pose>0.3 0 0.66025 0 0 0</pose>
            <inertial>
                <pose>-0.1 0 0.1 0 0 0</pose>
                <mass>150.0</mass>
                <inertia>
                    <ixx>1.55925</ixx>
                    <ixy>0</ixy>
                    <ixz>0</ixz>
                    <iyy>1.55925</iyy>
                    <iyz>0</iyz>
                    <izz>1.55925</izz>
                </inertia>
            </inertial>
            <collision name="base_link_collision">
                <pose>0.0 0 0.0 0 0 0</pose>
                <!-- <geometry>
                    <mesh>
                        <uri>meshes/camello_shell.stl</uri>
                    </mesh>
                </geometry> -->
                <geometry>
                    <box>
                        <size>0.92 0.656 1.2055</size>
                    </box>
                </geometry>
            </collision>
            <visual name="base_link_visual">
                <pose>0.0 0 0.0 1.57 0 1.57</pose>
                <geometry>
                    <mesh>
                        <uri>meshes/camello_shell.dae</uri>
                    </mesh>
                </geometry>
                <material>
                    <ambient>0.66 0.2 0.4 1</ambient>
                    <diffuse>0.66 0.2 0.4 1</diffuse>
                    <specular>0.66 0.2 0.4 1</specular>
                </material>
            </visual>
        </link>

        <!-- SENSORS -->

        <link name="camera_front_bottom">
            <pose relative_to="base_link">0.746, 0.048, 0.372 0 0 0</pose>
            <sensor name="color" type="camera">
                <pose>0 0.0325 0.0125 0 0 0</pose>
                <gz_frame_id>camera_front_btm_link</gz_frame_id>
                <!-- <topic>front_btm_realsense</topic> -->
                <update_rate>6</update_rate>
                <always_on>0</always_on>
                <camera>
                    <horizontal_fov>1.20427718</horizontal_fov>
                    <image>
                        <width>848</width>
                        <height>480</height>
                    </image>
                    <clip>
                        <near>0.1</near>
                        <far>50</far>
                    </clip>
                    <lens>
                        <intrinsics>
                            <fx>615.9603271484375</fx>
                            <fy>616.227294921875</fy>
                            <cx>419.83026123046875</cx>
                            <cy>245.1431427001953</cy>
                            <s>0</s>
                        </intrinsics>
                    </lens>
                </camera>
            </sensor>
            <sensor name="depth" type="depth_camera">
                <pose>0 0.0175 0.0125 0 0 0</pose>
                <gz_frame_id>camera_front_btm_link</gz_frame_id>
                <!-- <topic>front_btm_realsense</topic> -->
                <update_rate>6</update_rate>
                <always_on>0</always_on>
                <camera>
                    <horizontal_fov>1.51843645</horizontal_fov>
                    <image>
                        <width>848</width>
                        <height>480</height>
                        <format>R_FLOAT32</format>
                    </image>
                    <clip>
                        <near>0.1</near>
                        <far>10</far>
                    </clip>
                    <lens>
                        <intrinsics>
                            <fx>421.61578369140625</fx>
                            <fy>421.61578369140625</fy>
                            <cx>422.2854309082031</cx>
                            <cy>236.57237243652344</cy>
                            <s>0</s>
                        </intrinsics>
                    </lens>
                </camera>
            </sensor>
        </link>

        <joint name="camera_front_bottom_joint" type="fixed">
            <child>camera_front_bottom</child>
            <parent>base_link</parent>
        </joint>

        <link name="camera_front_top">
            <pose relative_to="base_link">0.746 0.048 0.372 0.000 0.870 0.000</pose>
            <sensor name="color" type="camera">
                <pose>0 0.0325 0.0125 0 0 0</pose>
                <gz_frame_id>camera_front_top_link</gz_frame_id>
                <!-- <topic>front_btm_realsense</topic> -->
                <update_rate>6</update_rate>
                <always_on>0</always_on>
                <camera>
                    <horizontal_fov>1.20427718</horizontal_fov>
                    <image>
                        <width>848</width>
                        <height>480</height>
                    </image>
                    <clip>
                        <near>0.1</near>
                        <far>50</far>
                    </clip>
                    <lens>
                        <intrinsics>
                            <fx>615.9603271484375</fx>
                            <fy>616.227294921875</fy>
                            <cx>419.83026123046875</cx>
                            <cy>245.1431427001953</cy>
                            <s>0</s>
                        </intrinsics>
                    </lens>
                </camera>
            </sensor>
            <sensor name="depth" type="depth_camera">
                <pose>0 0.0175 0.0125 0 0 0</pose>
                <gz_frame_id>camera_front_top_link</gz_frame_id>
                <!-- <topic>front_btm_realsense</topic> -->
                <update_rate>6</update_rate>
                <always_on>0</always_on>
                <camera>
                    <horizontal_fov>1.51843645</horizontal_fov>
                    <image>
                        <width>848</width>
                        <height>480</height>
                        <format>R_FLOAT32</format>
                    </image>
                    <clip>
                        <near>0.1</near>
                        <far>10</far>
                    </clip>
                    <lens>
                        <intrinsics>
                            <fx>421.61578369140625</fx>
                            <fy>421.61578369140625</fy>
                            <cx>422.2854309082031</cx>
                            <cy>236.57237243652344</cy>
                            <s>0</s>
                        </intrinsics>
                    </lens>
                </camera>
            </sensor>
        </link>

        <joint name="camera_front_top_joint" type="fixed">
            <child>camera_front_top</child>
            <parent>base_link</parent>
        </joint>

        <link name="camera_rear_bottom">
            <pose relative_to="base_link">-0.137, -0.018, 0.234 0 0 3.141592654</pose>
            <sensor name="color" type="camera">
                <pose>0 0.0325 0.0125 0 0 0</pose>
                <gz_frame_id>camera_rear_btm_link</gz_frame_id>
                <topic>camera_back</topic>
                <update_rate>6</update_rate>
                <always_on>0</always_on>
                <camera>
                    <horizontal_fov>1.20427718</horizontal_fov>
                    <image>
                        <width>848</width>
                        <height>480</height>
                    </image>
                    <clip>
                        <near>0.1</near>
                        <far>50</far>
                    </clip>
                    <lens>
                        <intrinsics>
                            <fx>615.9603271484375</fx>
                            <fy>616.227294921875</fy>
                            <cx>419.83026123046875</cx>
                            <cy>245.1431427001953</cy>
                            <s>0</s>
                        </intrinsics>
                    </lens>
                </camera>
            </sensor>
            <sensor name="depth" type="depth_camera">
                <pose>0 0.0175 0.0125 0 0 0</pose>
                <gz_frame_id>camera_rear_btm_link</gz_frame_id>
                <update_rate>6</update_rate>
                <always_on>0</always_on>
                <camera>
                    <horizontal_fov>1.51843645</horizontal_fov>
                    <image>
                        <width>848</width>
                        <height>480</height>
                        <format>R_FLOAT32</format>
                    </image>
                    <clip>
                        <near>0.1</near>
                        <far>10</far>
                    </clip>
                    <lens>
                        <intrinsics>
                            <fx>421.61578369140625</fx>
                            <fy>421.61578369140625</fy>
                            <cx>422.2854309082031</cx>
                            <cy>236.57237243652344</cy>
                            <s>0</s>
                        </intrinsics>
                    </lens>
                </camera>
            </sensor>
        </link>

        <joint name="camera_rear_bottom_joint" type="fixed">
            <child>camera_rear_bottom</child>
            <parent>base_link</parent>
        </joint>

        <link name="top_lidar">
            <pose>0.567 0 1.377 0 0 1.571</pose>
            <visual name="velodyne_base">
                <pose>0 0 -0.035 0 0 0</pose>
                <geometry>
                    <cylinder>
                        <radius>0.06</radius>
                        <length>0.0015</length>
                    </cylinder>
                </geometry>
            </visual>
            <visual name="velodyne_suport_1">
                <pose>-0.035 0.035 -0.08 0 0 0</pose>
                <geometry>
                    <cylinder>
                        <radius>0.005</radius>
                        <length>0.09</length>
                    </cylinder>
                </geometry>
            </visual>
            <visual name="velodyne_suport_2">
                <pose>-0.035 -0.035 -0.08 0 0 0</pose>
                <geometry>
                    <cylinder>
                        <radius>0.005</radius>
                        <length>0.09</length>
                    </cylinder>
                </geometry>
            </visual>
            <visual name="velodyne_suport_3">
                <pose>0.0495 0 -0.08 0 0 0</pose>
                <geometry>
                    <cylinder>
                        <radius>0.005</radius>
                        <length>0.09</length>
                    </cylinder>
                </geometry>
            </visual>
            <!-- Bottom cylinder of Ouster/Velodyne 3D Lidar -->
            <visual name="velodyne_base_link_visual_base">
                <pose>0 0 -0.035 0 0 0</pose>
                <geometry>
                    <mesh>
                        <scale>1 1 1</scale>
                        <uri>meshes/VLP16_base_1.dae</uri>
                    </mesh>
                </geometry>
            </visual>
            <!-- Top cylinder of Ouster/Velodyne 3D Lidar -->
            <visual name="velodyne_base_link_visual_sensor">
                <pose>0 0 -0.035 0 0 0</pose>
                <geometry>
                    <mesh>
                        <scale>1 1 1</scale>
                        <uri>meshes/VLP16_base_2.dae</uri>
                    </mesh>
                </geometry>
            </visual>
            <!-- Main cylinder of Ouster/Velodyne 3D Lidar -->
            <visual name="base_link_velodyne_visual_scan">
                <pose>0 0 -0.035 0 0 0</pose>
                <geometry>
                    <mesh>
                        <scale>1 1 1</scale>
                        <uri>meshes/VLP16_scan.dae</uri>
                    </mesh>
                </geometry>
            </visual>
            <sensor name="top_lidar" type="gpu_lidar">
                <gz_frame_id>velodyne</gz_frame_id>
                <!-- <topic>top_lidar</topic> -->
                <update_rate>10</update_rate>
                <lidar>
                    <scan>
                        <horizontal>
                            <samples>900</samples>
                            <resolution>1</resolution>
                            <min_angle>-3.141592654</min_angle>
                            <max_angle>3.141592654</max_angle>
                        </horizontal>
                        <vertical>
                            <samples>16</samples>
                            <resolution>1</resolution>
                            <min_angle>-0.261799388</min_angle>
                            <max_angle>0.261799388</max_angle>
                        </vertical>
                    </scan>
                    <range>
                        <min>0.2</min>
                        <max>100.0</max>
                        <resolution>0.01</resolution>
                    </range>
                </lidar>
            </sensor>
        </link>

        <joint name="top_lidar_joint" type="fixed">
            <child>top_lidar</child>
            <parent>base_link</parent>
        </joint>

        <!-- WHEELS -->
        <link name="wheel_front_left">
            <pose>0.6 0.2885 0.133 -1.570796327 0.0 0.0</pose>
            <inertial>
                <pose>0 0 0 0 0 0</pose>
                <mass>0.1</mass>
                <inertia>
                    <ixx>0.0000175</ixx>
                    <ixy>0</ixy>
                    <ixz>0</ixz>
                    <iyy>0.0000175</iyy>
                    <iyz>0</iyz>
                    <izz>0.0000175</izz>
                </inertia>
            </inertial>
            <collision name="wheel_front_left_collision">
                <pose>0 0 0 0 0 0</pose>
                <geometry>
                    <sphere>
                        <radius>0.133</radius>
                    </sphere>
                </geometry>
                <max_contacts>2</max_contacts>
                <surface>
                    <contact>
                        <ode>
                            <kp>1000000.0</kp>
                            <kd>1</kd>
                            <min_depth>0.01</min_depth>
                            <max_vel>1</max_vel>
                        </ode>
                    </contact>
                    <friction>
                        <ode>
                            <mu>1.16</mu>
                            <mu2>1.16</mu2>
                        </ode>
                    </friction>
                </surface>
            </collision>
            <visual name="wheel_front_left_visual">
                <pose>0.0 0.0 0.0 0.0 0.0 0.0</pose>
                <geometry>
                    <mesh>
                        <scale>0.67 0.67 1.0</scale>
                        <uri>meshes/wheel/wheel.dae</uri>
                    </mesh>
                </geometry>
            </visual>
        </link>

        <joint name="wheel_front_left_joint" type="ball">
            <child>wheel_front_left</child>
            <parent>base_link</parent>
            <axis>
                <limit>
                    <effort>100</effort>
                </limit>
                <dynamics>
                    <spring_reference>0</spring_reference>
                    <spring_stiffness>0</spring_stiffness>
                    <damping>10</damping>
                </dynamics>
            </axis>
        </joint>

        <link name="wheel_front_right">
            <pose> 0.6 -0.2885 0.133 1.570796327 0.0 0.0 </pose>
            <inertial>
                <pose>0 0 0 0 0 0</pose>
                <mass>0.1</mass>
                <inertia>
                    <ixx>0.0000175</ixx>
                    <ixy>0</ixy>
                    <ixz>0</ixz>
                    <iyy>0.0000175</iyy>
                    <iyz>0</iyz>
                    <izz>0.0000175</izz>
                </inertia>
            </inertial>
            <collision name="wheel_front_right_collision">
                <pose>0 0 0 0 0 0</pose>
                <geometry>
                    <sphere>
                        <radius>0.035</radius>
                    </sphere>
                </geometry>
                <max_contacts>2</max_contacts>
                <surface>
                    <contact>
                        <ode>
                            <kp>1000000.0</kp>
                            <kd>1</kd>
                            <min_depth>0.01</min_depth>
                            <max_vel>1</max_vel>
                        </ode>
                    </contact>
                    <friction>
                        <ode>
                            <mu>1.16</mu>
                            <mu2>1.16</mu2>
                        </ode>
                    </friction>
                </surface>
            </collision>
            <visual name="wheel_front_right_visual">
                <pose>0.0 0.0 0.0 0.0 0.0 0.0 </pose>
                <geometry>
                    <mesh>
                        <scale>0.67 0.67 1.0</scale>
                        <uri>meshes/wheel/wheel.dae</uri>
                    </mesh>
                </geometry>
            </visual>
        </link>

        <joint name="wheel_front_right_joint" type="ball">
            <child>wheel_front_right</child>
            <parent>base_link</parent>
            <axis>
                <limit>
                    <effort>100</effort>
                </limit>
                <dynamics>
                    <spring_reference>0</spring_reference>
                    <spring_stiffness>0</spring_stiffness>
                    <damping>10</damping>
                </dynamics>
            </axis>
        </joint>

        <link name="wheel_left">
            <pose>0 0.2885 0.133 -1.570796327 0 0</pose>
            <inertial>
                <pose>0 0 0 0 0 0</pose>
                <mass>0.1</mass>
                <inertia>
                    <ixx>0.0000175</ixx>
                    <ixy>0</ixy>
                    <ixz>0</ixz>
                    <iyy>0.0000175</iyy>
                    <iyz>0</iyz>
                    <izz>0.00003125</izz>
                </inertia>
            </inertial>
            <collision name="wheel_left_collision">
                <pose>0 0 0 0 0 0</pose>
                <geometry>
                    <cylinder>
                        <radius>0.133</radius>
                        <length>0.05</length>
                    </cylinder>
                </geometry>
                <max_contacts>5</max_contacts>
                <surface>
                    <contact>
                        <ode>
                            <kp>1000000.0</kp>
                            <kd>1</kd>
                            <min_depth>0.01</min_depth>
                            <max_vel>1</max_vel>
                        </ode>
                    </contact>
                    <friction>
                        <ode>
                            <mu>1.16</mu>
                            <mu2>10</mu2>
                            <fdir1>1 0 0</fdir1>
                        </ode>
                    </friction>
                </surface>
            </collision>
            <visual name="wheel_left_visual">
                <pose>0 0 0.0 0 0 0</pose>
                <geometry>
                    <mesh>
                        <scale>0.67 0.67 1.0</scale>
                        <uri>meshes/wheel/wheel.dae</uri>
                    </mesh>
                </geometry>
            </visual>
        </link>

        <joint name="wheel_left_joint" type="revolute">
            <child>wheel_left</child>
            <parent>base_link</parent>
            <axis>
                <xyz>0 0 1</xyz>
                <limit>
                    <effort>9.6</effort>
                </limit>
                <dynamics>
                    <damping>3.0</damping>
                    <friction>0.5</friction>
                </dynamics>
            </axis>
        </joint>

        <link name="wheel_right">
            <pose>0 -0.2885 0.133 1.570796327 0 0</pose>
            <inertial>
                <pose>0 0 0 0 0 0</pose>
                <mass>0.1</mass>
                <inertia>
                    <ixx>0.0000175</ixx>
                    <ixy>0</ixy>
                    <ixz>0</ixz>
                    <iyy>0.0000175</iyy>
                    <iyz>0</iyz>
                    <izz>0.00003125</izz>
                </inertia>
            </inertial>
            <collision name="wheel_right_collision">
                <pose>0 0 0 0 0 0</pose>
                <geometry>
                    <cylinder>
                        <radius>0.133</radius>
                        <length>0.05</length>
                    </cylinder>
                </geometry>
                <max_contacts>5</max_contacts>
                <surface>
                    <contact>
                        <ode>
                            <kp>1000000.0</kp>
                            <kd>1</kd>
                            <min_depth>0.01</min_depth>
                            <max_vel>1</max_vel>
                        </ode>
                    </contact>
                    <friction>
                        <ode>
                            <mu>1.16</mu>
                            <mu2>10</mu2>
                            <fdir1>1 0 0</fdir1>
                        </ode>
                    </friction>
                </surface>
            </collision>
            <visual name="wheel_right_visual">
                <pose>0 0 -0.03 0 0 0</pose>
                <geometry>
                    <mesh>
                        <scale>0.67 0.67 1.0</scale>
                        <uri>meshes/wheel/wheel.dae</uri>
                    </mesh>
                </geometry>
            </visual>
        </link>

        <joint name="wheel_right_joint" type="revolute">
            <child>wheel_right</child>
            <parent>base_link</parent>
            <axis>
                <xyz>0 0 -1</xyz>
                <limit>
                    <effort>9.6</effort>
                </limit>
                <dynamics>
                    <damping>3.0</damping>
                    <friction>0.5</friction>
                </dynamics>
            </axis>
        </joint>

        <!-- CONTROLERS PLUGINS -->
        <!-- DIFF DRIVE PLUGIN / WHEELS CONTROLER -->
        <plugin filename="ignition-gazebo-diff-drive-system" name="ignition::gazebo::systems::DiffDrive">
            <left_joint>wheel_left_joint</left_joint>
            <right_joint>wheel_right_joint</right_joint>
            <wheel_separation>0.577</wheel_separation>
            <wheel_radius>0.133</wheel_radius>
            <odom_publish_frequency>20</odom_publish_frequency>
            <frame_id>odom</frame_id>
            <child_frame_id>base_link</child_frame_id>
        </plugin>

        <!-- GROUND ODOMETRY POSITION STATE PUBLISHER (FAKE LOCALIZATION) -->
        <plugin filename="ignition-gazebo-pose-publisher-system" name="ignition::gazebo::systems::PosePublisher">
            <publish_link_pose>true</publish_link_pose>
            <publish_collision_pose>false</publish_collision_pose>
            <publish_visual_pose>false</publish_visual_pose>
            <publish_sensor_pose>false</publish_sensor_pose>
            <publish_nested_model_pose>true</publish_nested_model_pose>
            <update_frequency>20</update_frequency>
        </plugin>

        <plugin filename="ignition-gazebo-linearbatteryplugin-system" name="ignition::gazebo::systems::LinearBatteryPlugin">
            <battery_name>linear_battery</battery_name>
            <voltage>24.592</voltage>
            <open_circuit_voltage_constant_coef>24.592</open_circuit_voltage_constant_coef>
            <capacity>1.2009</capacity>
            <power_load>6.5</power_load>
            <fix_issue_225>true</fix_issue_225>
            <enable_recharge>true</enable_recharge>
            <!-- charging I = c / t, discharging I = P / V, 
          charging I should be > discharging I -->
            <charging_time>3.0</charging_time>
            <!-- Consumer-specific -->
            <!-- <power_load>2.1</power_load> -->
            <recharge_by_topic>true</recharge_by_topic>
        </plugin>

    </model>
</sdf>